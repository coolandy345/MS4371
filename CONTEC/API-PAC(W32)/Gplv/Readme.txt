=====================================================================
=          LabVIEW対応GPIBドライバ(API-GPLV(W32))について           =
=                                            API-GPLV(W32) Ver4.00  =
=                                                  CONTEC Co.,Ltd.  =
=====================================================================


◆ 目次
=======
  はじめに
  注意事項
  バージョンアップ履歴


◆ はじめに
===========
  日頃から格別のお引き立てを賜りまして厚く御礼申し上げます。

  API-GPLV(W32)に関する説明を以下に記載します。ヘルプ等に記載されてい
  ない事項もありますので、ぜひご一読下さい。


◆注意事項
==========
  ・弊社LabVIEW対応GPIBドライバは、NI社GPIBドライバと共存して使用することはできません。

  ・ご使用の環境において、National Instruments社(以下NI社)のGPIBドライバが
    既にインストールされている環境に本ドライバをインストールされる場合、
    NI社のドライバをアンインストールするとデバイスの認識が正常に行えなくなります。
    このため、上記に該当する場合はNI社のドライバをアンインストールせずに
    本ドライバをインストールしてください。
    なお、既にシステムフォルダにあるGPIB-32.DLLは、GPIB-32.1にファイル名が変更されます。

  ・インストール時は、Administrator権限でログインして下さい。

  ・サンプルのコンパイルについて
    「Program Files」以下のフォルダでは、サンプルのコンパイルに失敗する場合があります。
    その際は、Sample以下のフォルダを、任意のフォルダにコピーしてからご使用ください。


◆インストール方法（Webダウンロード）
============================
  ・弊社ホームページよりダウンロード、展開した場合は
    以下のインストーラを実行してください。

   [1]
   ・サンプルプログラムが必要ない場合：
     実行環境(ランタイム)のみ
     <展開先フォルダ>\APIPAC\Runtime\GPLV\Disk1\Setup.exe
     
   ・サンプルプログラムが必要な場合：
     実行環境(ランタイム)は自動的にインストールされてます。
     開発環境(フルセット)
     <展開先フォルダ>\APIPAC\GPLV\Disk1\Setup.exe

   [2]
   デバイスドライバのインストール
   以下ヘルプファイルをご参照ください。
    <展開先フォルダ>\HELP\Jpn\GpibCmpt.chm


◆バージョンアップ履歴
=======================
 Ver3.11->Ver4.00 (Web Release Jun.2021)
  --------------------------------------
  ・Windows 10 21H1での動作を確認
  ・対応OSを改定
    対応OS:       Microsoft Windows 10        (32bit/64bit)
                  Microsoft Windows 10 IoT Enterprise LTSB 2016  (64bit)
                  Microsoft Windows 10 IoT Enterprise 2019 LTSC  (64bit)
  ・対応開発言語を改定
    対応開発言語: LabVIEW 2020 SP1            (32ビット版)
                  Microsoft Visual Basic .NET (2010,2012,2013,2015,2017,2019)
                  Microsoft Visual C#         (2010,2012,2013,2015,2017,2019)
                  Microsoft Visual C++ (MFC)  (2010,2012,2013,2015,2017,2019)
  ・以下デバイスのサポートを終了
    GP-IB(PC)L, GP-IB(PCI), GP-IB(PCI)L, GP-IB(CPCI)F
    GP-IB(PM), GP-IB(CB)F, GP-IB(CB)FL

 Ver3.10->Ver3.11 (Web Release Jan.2021)
  ----------------------------------------
  ・Windows10 のセキュリティポリシー(メモリの整合性)に対応

 Ver3.00->Ver3.10 (Web Release Dec.2020)
  ----------------------------------------
  ・Windows 10 20H2での動作を確認
  ・対応OSを改定
    対応OS:       Microsoft Windows 10        (32bit/64bit)
                  Microsoft Windows 8.1       (32bit/64bit)
                  Microsoft Windows 7         (32bit/64bit)
  ・対応開発言語を改定
    対応開発言語: Microsoft Visual Basic .NET (2010,2012,2013,2015,2017,2019)
                  Microsoft Visual C#         (2010,2012,2013,2015,2017,2019)
                  Microsoft Visual C++ (MFC)  (2010,2012,2013,2015,2017,2019)

 Ver2.90->Ver3.00 (Web Release Jul.2020)
  ----------------------------------------
  ・Windows 10 2004での動作を確認

 Ver2.80->Ver2.90 (Web Release Dec.2019)
  ----------------------------------------
  ・Windows 10 19H2での動作を確認

 Ver2.70->Ver2.80 (Web Release Aug.2019)
  ----------------------------------------
  ・Visual Studio 2019に対応

 Ver2.60->Ver2.70 (Web Release Jul.2019)
  ----------------------------------------
  ・Windows 10 19H1での動作を確認

 Ver2.50->Ver2.60 (Web Release Nov.2018)
  ----------------------------------------
  ・対応デバイスを追加
    対応デバイス: GPIB-FL2-USB

 Ver2.40->Ver2.50 (Web Release)
  ----------------------------------------
  ・対応開発言語を追加
    対応開発言語: Microsoft Visual Basic 2017
                  Microsoft Visual C# 2017
                  Microsoft Visual C++ 2017

 Ver2.30->Ver2.40 (Web Release)
  ----------------------------------------
  ・WOW64対応 (Fシリーズ, Windows 7 以降)
  ・対応OSを追加
    対応OS: Microsoft Windows 8.1
            Microsoft Windows 10
            Microsoft Windows 8.1 x64 Edition
            Microsoft Windows 10  x64 Edition
  ・対応開発言語を追加
  ・対応開発言語: Microsoft Visual Basic.NET    2012、2013、2015
                  Microsoft Visual C#.NET       2012、2013、2015
                  Microsoft Visual C++.NET      2012、2013、2015
  ・LabVIEW2014に対応(32ビット版)
  ・アナライザの不具合を修正

 Ver2.20->Ver2.30 (Web Release)
  ----------------------------------------
  ・対応開発言語を追加
    対応開発言語: Microsoft Visual Basic 2010
                  Microsoft Visual C# 2010
                  Microsoft Visual C++ 2010
  ・LabVIEW2010に対応(32ビット版)

 Ver2.10->Ver2.20 (API-USBP(WDM) Ver4.40)
  ----------------------------------------
  ・対応OS追加
    対応OS: Microsoft Windows 7 x64 Edition
            Microsoft Windows Vista x64 Edition
            Microsoft Windows Server 2003 x64 Edition
            Microsoft Windows XP Professional x64 Edition
  ・Visual Basic.NET用関数宣言ファイルを修正

 Ver2.01->Ver2.10 (API-USBP(WDM) Ver4.10)
  ----------------------------------------
  ・Windows 7に対応
  ・LabVIEW2009に対応
  ・ibwrta(), ibrda(), ibwait()の戻り値がNI-488.2と異なっていたため修正
  ・自己診断プログラムで使用モードが正しく表示されない不具合修正
  ・診断レポートの"カード挿入順"の表示が文字化けする問題を修正

 Ver2.00->Ver2.01 (Web提供 2009.05.20)
  -----------------------------------------
  ・LabVIEW8.2/8.5/8.6に対応

 Ver1.90->Ver2.00 (Web提供 2009.02.16)
  ----------------------------------------
  ・自己診断プログラムでOSが正しく表示されない不具合修正

 Ver1.80->Ver1.90 (API-PAC(W32) Ver.Jan.2009)
  ----------------------------------------
  ・ibrd()の戻り値にENDビットが立たない不具合修正
  ・ibwrta()、ibrda()関数実行時、タイムアウトエラーが発生する不具合修正
  ・Windows2000にてアナライザが正しく表示されない不具合修正
  ・アナライザでヘルプが表示されない不具合修正

 Ver1.71->Ver1.80 (API-PAC(W32) Ver.Oct.2008)
  ----------------------------------------
  ・デバイスドライバ部分を更新。Gpib-32.dllは変更無し。

 Ver1.70->Ver1.71 (API-USBP(WDM) Ver3.80)
  ----------------------------------------
  ・対応開発言語を追加
    対応開発言語: Microsoft Visual Basic.NET 2008
                  Microsoft Visual C#.NET 2008
                  Microsoft Visual C++.NET 2008
  以下、Fシリーズのボードに関連する修正
  ・正常送信終了時にタイムアウトエラーが発生するタイミングがある不具合修正

 Ver1.67->Ver1.70 (2008.03.18)
  ----------------------------------------
  ・SRQ受信時のコールバック動作修正

 Ver1.66->Ver1.67 (API-PAC(W32) Ver.Oct.2007, API-USBP(WDM) Ver3.70)
  ----------------------------------------
  ・対応開発言語を追加
    対応開発言語: Microsoft Visual Basic 2005 Express Edition
                  Microsoft Visual C# 2005 Express Edition
  ・GP-IB(USB)FL使用時、プロパティページの転送モード選択を変更
  ・GP-IB(USB)FL使用時、初期化実行中にUSBケーブルを抜くと、その後再接続しても復帰しなくなる不具合修正
  以下、Fシリーズ以外のボードに関する不具合修正
  ・スレーブモードにおいて、送信終了時にタイムアウトエラーとなる場合がある問題に対応

 Ver1.65->Ver1.66 (API-USBP(WDM) Ver3.50)
  ----------------------------------------
  ・Windows VistaでNConfig.exeが正しく動作しない不具合修正
  ・自己診断プログラムで、バイナリ受信データが正しく反映されていない不具合修正

 Ver1.64->Ver1.65 (Web提供 2007.02.09)
  ----------------------------------------
  ・Windows Vistaに対応
  以下、Fシリーズのボードに関連する修正
  ・CPU負荷が高い場合、受信で先頭の1バイト欠けが発生するタイミングがある不具合修正

 Ver1.61->Ver1.63 (API-PAC(W32) Ver.Aug.2006, API-USBP(WDM)Ver 3.40)
  ----------------------------------------
  ・LabVIEW8.0に対応
  以下、Fシリーズ以外のボードに関する不具合修正
 ・バイナリデータ受信時、受信データに依ってブルーバックが発生する不具合修正
  以下、Fシリーズのボードに関連する修正
 ・SRQのステータスが異常となる不具合修正
 ・シリアルポール時にタイムアウトとなる問題対応

  Ver1.60->Ver1.61 (Web提供 2006.05.31)
  --------------------------------
 ・受信後のシリアルポールでタイムアウトが発生する不具合修正
 ・BusMasterモード及びFIFOモードにおいて、送信->受信->受信と動作した場合に正常に受信できない不具合修正
 ・BusMasterモードで、CPU速度に依って正常に送信できない不具合修正

  Ver1.54->Ver1.60 (API-PAC(W32) Ver.Apr.2006)
  --------------------------------
  ・GPIB-F-LPE、GPIB-FL-LPEをサポート

  Ver1.53->Ver1.54 (API-USBP(WDM) Ver 3.20)
  --------------------------------
 ・GP-IB(USB)FLをサポート
  ・USBファームウェアアップデートツールを追加
   以下、Fシリーズのボードに関連する修正
  ・GpBoardstsEx()でマイドレス変更が反映されない不具合修正
  ・マスタモードにおいて、FIFO動作で受信予定バイト数と同じデータサイズのデータを受信すると、
    受信データの最終バイトが欠ける不具合修正
  ・GpibSendTrigger()、GpibChangeLocal()関数が正常に動作しない不具合修正
  ・GpibSetNotifySignal()においてステータスが上がり続ける不具合修正
  ・SRQイベントが止まらなくなる不具合修正
  ・GpibSetNotifySignal()のキャンセルが動作しなかった不具合修正
   
  Ver1.50->Ver1.53 (API-PAC(W32) Ver.Feb.2006)
  --------------------------------
  以下、Fシリーズ以外のボードに関する不具合修正
  ・GP-IB(PM)使用時、シャットダウンできない場合がある不具合修正
  ・マスタモードで、シリアルポール後、受信でタイムアウトが発生する不具合修正
  以下、Fシリーズのボードに関連する修正
  ・HTマシンにおいて、パラメータエラー、不正な呼び出しとなるタイミングがある不具合修正
  ・CPU負荷が高い場合、受信で先頭の1バイト欠けが発生するタイミングがある不具合修正
  ・マスタモードで、シリアルポール後の受信でタイムアウトが発生する不具合修正
  ・マスタモードで、受信後のシリアルポールでタイムアウトが発生する不具合修正

  Ver1.41->Ver1.50 (API-PAC(W32) Ver.Nov.2005)
  --------------------------------
  Fシリーズのボードに関連する修正
  ・受信中にSRQを受信すると受信関数でタイムアウトが発生する不具合修正
  ・バスマスタ転送中にCPU使用率が100%となる問題に対応
  ・パラレルポール構成実行時に、同相と異相の切り替え設定が反映されない不具合修正
  ・マスタモードで、送信後のシリアルポール時にステータスバイトを取得できない不具合修正

  Ver1.40->Ver1.41 (API-PAC(W32) Ver.Aug.2005)
  --------------------------------
  ・Windows Server 2003に対応
  Fシリーズのボードに関連する修正
  ・ボードの型式が正しく認識されない不具合修正
  ・マルチプロセス実行時、プロセスの終了で別のプロセスの通信が停止する不具合修正

  Ver1.36->Ver1.40 (API-PAC(W32) Ver.Apr.2005)
  --------------------------------
  ・GP-IB(LPCI)FL/GP-IB(CB)FLをサポート
  ・バイナリ送受信が正常にできない不具合を修正
  ・送信コマンド数が戻らない不具合を修正
  ・NI-VISAで相手機器検索が動作するように修正
  以下、GP-IB(PCI)F/FL、GP-IB(CB)F、GP-IB(CPCI)F、GP-IB(LPCI)Fのみ対象
  ・NI-488.2のVer2.xx以降がインストールされている場合でもNI-VISA関数が正常動作するようにプロパティを修正
  ・ibfind関数でデバイスデスクリプタが取得できない場合がある不具合を修正

  Ver1.35->Ver1.36 (API-PAC(W32) Ver.Jan.2005)
  --------------------------------
  ・ibrsc()の戻り値にセットした値を戻すように修正
  ・TriggerDevices(), SendLLO(), EnableRemote()の戻り値に送信コマンドを戻すように修正
  ・SendDataBytes()の動作不具合を修正

  Ver1.34->Ver1.35 (API-PAC(W32) Ver.Oct.2004)
  --------------------------------
  ・LabVIEW7.0/7.1に対応（Express VIは未対応）
  ・ボードレベル使用時にibonl()が正常に動作しない不具合修正。
  ・ボードレベル使用時にibnotify()がコールバックの戻り値で正常に動作しない不具合修正。
  ・Ver1.32以降のバージョンでSend()を使用時にCR/LFが付加されていた不具合修正。
  以下、GP-IB(PCI)F/FL、GP-IB(CB)F、GP-IB(CPCI)F、GP-IB(LPCI)Fのみ対象
  ・Ver1.33以降のバージョンでibwrta()/ibrda()が正常に動作しない不具合修正。
  ・ibeot()が正常に動作しない不具合修正。
  ・マルチCPU、Hyper-ThreadingテクノロジCPUに対応。

  Ver1.33->Ver1.34 (Web提供 2004.03.17)
  --------------------------------
  ・AutoPoll機能が正常に動作しない不具合を修正。

  Ver1.32->Ver1.33 (API-PAC(W32) Ver.Nov.2003)
  --------------------------------
  ・デバイスドライバ部分(CGpib.sys)を更新。Gpib-32.dllは変更無し。

  Ver1.31->Ver1.32(Web提供 2003.09.19)
  --------------------------------
  ・ポーリング実行時、エラーが発生することがある不具合修正。

  Ver1.30->Ver1.31 (Web提供 2003.03.07)
  --------------------------------
  ・LabVIEW6.1をサポート
  ・LabVIEW6i/6.1のVISA関数が正常に動作しない問題を修正(WinNT系のみ、
    Win9x系は未サポート)。
  ・GP-IB(PCI)F/FL、GP-IB(CB)F、GP-IB(CPCI)F、GP-IB(LPCI)Fにおいて、
    iblines()が逆のラインステータスを返してしまう問題を修正。

  Ver1.21->Ver1.30 (API-PAC(W32) Ver.Dec.2002)
  --------------------------------
  ・GP-IB(PCI)F、GP-IB(PCI)FL、GP-IB(CPCI)F、GP-IB(CB)F、GP-IB(LPCI)F
    GP-IB(LPCI)FLをサポート。
  ・ibconfig()において、CICプロトコルに対し、パラメータが0であればエ
    ラーにならないように修正。
  ・ibfind()でデバイスレベルの指定("DEV5"等)をした場合、指定した
    PrimaryAddressが取得できない問題を修正。
  ・ボードレベルにおいて、ibsic()を実行しないとibsre()がエラーになる
    問題を修正。
  ・Visual Basic.NETに対応。
  ・Visual C++.NETに対応。

  Ver1.20->Ver1.21 (API-PAC(W32) Ver.Aug.2002)
  --------------------------------
  ・デバイスドライバ部分(ApiGpib*.dll/sys/vxd)を更新。Gpib-32.dllは変
    更無し。

  Ver1.10->Ver1.20 (Web提供 2002.04.25)
  --------------------------------
  ・関数の実装追加(ibbna)。
  ・Agilent社製IntuiLinkで正しく動作しない問題に対処(33250A(ファンシ
    ョンジェネレータ)、E3631A(電圧源)にて確認)。
  ・自動シリアルポールを有効にした場合、環境によって正しく動作しない
    (アプリケーションがハングする)場合があった問題を修正。
  ・設定ユーティリティ(NConfig.exe)において、WindowsXP/2000上で
    GP-IB(PM)を表示した場合、「InsertPriority」が1を設定したにも関わ
    らず2と表示される問題を修正。

  Ver1.00->Ver1.10 (API-PAC(W32) Ver.Jan.2002)
  --------------------------------
  ・WindowsXP対応。
  ・WindowsNT環境下でPCIボードリソースが規格範囲外にある場合でもアク
    セスできるように修正。
  ・インストールの最後に自動的に実行されたNConfig.exe(設定ユーティリ
    ティ)でボードの登録を行い、その後変更を行わないとLabVIEWで動作し
    ない問題を修正。
  ・API-PAC(W32) CDへ一本化。

  Ver1.00 2001.09.12
  ------------------
  ・Webにて新規リリース。

  Ver0.91 2001.08.07
  ------------------
  ・関数の実装追加(自動シリアルポール、ibnotify)。

  Ver0.90 2001.06.07
  ------------------
  ・関数の実装追加(自動シリアルポール、ibbna、ibnotify除く)。

  Ver0.80 2001.03.29
  ------------------
  ・新規作成


